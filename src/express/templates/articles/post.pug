extends ../common/layout.pug
include ../common/mixins/categories-list.pug

block wrapper
 .wrapper

  block header
    - const status = user.role
    case status
      when 'author'
        include ../common/header-admin.pug
      when 'reader'
        include ../common/header-logged.pug
      default
        include ../common/header.pug

  block content
    main
      section.post
        h1.visually-hidden Пост
        section.post__content
          h2.visually-hidden Основное содержание
          .post__wrapper
            .post__head
              a.post__backwards.button.button--backwards(href='#') Назад
              time.post__date(datetime='2019-03-21T20:33')= data.createdDate
              h2.post__title.title.title--main= data.title
              ul.post__themes.themes
                each item in categories
                  li.themes__item
                    a.themes__item-link(href='#')= item.title
                      sup= item.articlesAmount
                    button.themes__remove-btn(type='button') Удалить категорию
            - const hasPicture = data.picture !== null && data.picture !== ''
            if hasPicture
              .post__picture
                img(src='/img/' + data.picture alt='Фотография' + data.picture)
            .post__text
              h3= data.announce
              p= data.fullText
        .post__wrapper.post__wrapper--comments
          section.post__comments.comments
            - const hasComments = data.comments.length > 0
            if hasComments
              h2.comments__title.title.title--middle Комментарии
              ul.comments__list
                each item in comments
                  li.comments__comment
                    .comments__avatar.avatar
                      img(src='/img/' + item.readerId.avatar alt='аватар пользователя')
                    .comments__text
                      .comments__head
                        p= item.readerId.firstname + ' ' + item.readerId.lastname + ' •'
                        time.comments__date(datetime='2019-03-21T20:33')= item.createdDate
                      p.comments__message= item.text
            else
              h2.comments__title.title.title--middle Комментарии отсутствуют
            - const authorized = user.role === `author` || user.role === `reader`
            if authorized
              .comments__footer.comments__footer--user
                form(action='#' method='POST')
                  .comments__avatar.avatar
                    img(src='/img/avatar-2.png' alt='аватар пользователя')
                  label
                    textarea(rows='1' placeholder='Присоединиться к обсуждению')
                  button.comments__button.button.button--colored(type='submit') Опубликовать
            else
              .comments__footer.comments__footer--visitor
                a(href='/login')
                  button.comments__button.button.button--colored(type='submit') Войти
                .comments__registration
                  p.text.text--signature
                    b.title.title--small Регистрация
                    | Чтобы присоединиться к переписке нужно зарегистрироваться

  block footer
    include ../common/footer.pug

block script
  script(src='/js/main.js')
